<!DOCTYPE html>
<html lang="en">

<head>

	<title>BHealthy</title>
	<meta charset="utf-8">
	<script src="https://cdn.syncfusion.com/ej2/dist/ej2.min.js"></script>
	<link href="https://cdn.syncfusion.com/ej2/material.css" rel="stylesheet">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="CareMed demo project">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="styles/bootstrap4/bootstrap.min.css">
	<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
	<link rel="stylesheet" type="text/css" href="styles/doctor_profile.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
		integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
		crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
		integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
	<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
	<!-- <link rel="stylesheet" type="text/css" href="styles/main_styles.css"> -->
	<link rel="stylesheet" type="text/css" href="styles/home.css">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
	<script src="js/url.js"></script>

</head>

<body>

	<div class="super_container">

		<!-- Header -->

		<header class="header trans_200">

			<!-- Top Bar -->
			<div class="top_bar">
				<div class="container">
					<div class="row">
						<div class="col">
							<div class="top_bar_content d-flex flex-row align-items-center justify-content-start">

								<div
									class="top_bar_item_register  d-flex flex-row align-items-center justify-content-start ml-auto">
									<a href="#con" id="register">Register</a>
									<div id="con">
										<h4><input type="radio" name="role" value="1" /> As a Doctor</h4> <br> <br>
										<h4><input type="radio" name="role" value="0" /> As a Patient</h4>
									</div>
									<script>
										$('input:radio[name="role"]').change(
											function () {
												if ($(this).is(':checked') && $(this).val() == '1') {
													window.location = "doctor_signup.html";
												}
												else {
													window.location = "sign_up.html";
												}
											});
									</script>
								</div>

								<div class="top_bar_item_logIn  d-flex flex-row align-items-center"><a href="login.html"
										id="login">Login</a></div>


								<div class="dropdown" id="menu">
									<button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown"
										id="dropdown">hello
										<span class="caret"></span></button>
									<ul class="dropdown-content">
										<li><a href="patient_list.html">Track Patient List</a></li>
										<li><a href="javascript: logout()">Logout</a></li>
									</ul>

								</div>
								<script>
									function logout() {
										window.localStorage.clear();
										window.location.replace("home.html");
									}
								</script>
								<script>


									if (window.localStorage.getItem('user') == null) {
										document.getElementById('register').style.display = "block";
										document.getElementById('login').style.display = "block";
										document.getElementById('menu').style.display = "none";


									}
									else {
										document.getElementById('register').style.display = "none";
										document.getElementById('login').style.display = "none";
										document.getElementById('menu').style.display = "block";

										var data = window.localStorage.getItem('user');
										var obj = JSON.parse(data);


										document.getElementById('dropdown').innerHTML = obj.name;

									}
								</script>


								<div class="top_bar_item_logIn  d-flex flex-row align-items-center" id="username"><a
										href="login.html" style="display:none;">Nayeem</a></div>

							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Header Content -->
			<div class="header_container">
				<div class="container">
					<div class="row">
						<div class="col">
							<div class="header_content d-flex flex-row align-items-center justify-content-start">
								<nav class="main_nav ml-auto">
									<ul>
										<li><a href="home.html">Home</a></li>
										<li><a href="department.html">Department</a></li>
										<li><a href="home.html">Doctor</a></li>
										<!-- <li><a href="about.html">About us</a></li>
										<li><a href="contact.html">Contact us</a></li> -->
									</ul>
								</nav>
								<div class="hamburger ml-auto"><i class="fa fa-bars" aria-hidden="true"></i></div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Logo -->
			<div class="logo_container_outer">
				<div class="container">
					<div class="row">
						<div class="col">
							<div class="logo_container">
								<a href="#">
									<div
										class="logo_content d-flex flex-column align-items-start justify-content-center">
										<div class="logo_line"></div>
										<div class="logo d-flex flex-row align-items-center justify-content-center">
											<div class="logo_text">B<span>Healthy</span></div>
											<div class="logo_box">+</div>
										</div>
										<div class="logo_sub">Health Care Center</div>
									</div>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</header>


		<div class="col-md-10  containter">

			<div class="container pull-left col-md-5" style="margin-top: 220px; margin-left: 250px;">
				<div class="container  pull-left">
					<div class="image_container"><img id="propic"></div>
					<div class="containter" id="profile">

					</div>
				</div>
			</div>

			<script>
				function getUrlVars() {
					var vars = {};
					var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
						vars[key] = value;
					});
					return vars;
				}

				var profile = document.getElementById('profile');
				var namedoctor = document.createElement('div');
				namedoctor.setAttribute('class', 'title');
				// name.textContent = 'hiiiii'
				profile.appendChild(namedoctor);

				var department = document.createElement('div');
				var degree = document.createElement('div');
				var doctorlocation = document.createElement('div');
				var visiting_hour = document.createElement('div');
				var fee = document.createElement('div');

				department.setAttribute('class', 'title');
				degree.setAttribute('class', 'title');
				doctorlocation.setAttribute('class', 'title');
				visiting_hour.setAttribute('class', 'title');
				fee.setAttribute('class', 'title');
				profile.appendChild(department);
				profile.appendChild(degree);
				profile.appendChild(doctorlocation);
				profile.appendChild(visiting_hour);
				profile.appendChild(fee);






				var id = window.localStorage.getItem('user');
				var obj = JSON.parse(id);
				console.log(obj.phonenumber)
				var url = backendurl + "api/auth/single_doctor/" + obj.phonenumber;

				var xhr = new XMLHttpRequest();
				xhr.open("GET", url, true);
				xhr.onload = function () {
					if (this.status == 200) {
						console.log(this.response);
						var dataJSON = JSON.parse(this.response)
						console.log(dataJSON);

						namedoctor.textContent = "Name :    " + dataJSON.name;
						degree.textContent = "Degree :    " + dataJSON.degree;
						doctorlocation.textContent = "Location :    " + dataJSON.location;
						visiting_hour.textContent = "Visiting Hour :     " + dataJSON.visiting_hour;
						fee.textContent = "Visiting Fee :     " + dataJSON.fee;
						department.textContent = "Department :    " + dataJSON.department;

						document.getElementById('propic').src = dataJSON.image;




					}
				};
				xhr.send();

			</script>


			<div class=" pull-right col-md-4" style="margin-top: 300px;">




				<div class="date_picker">

					<input id="datepicker" width="276" placeholder="Date" />
					<script>
						$('#datepicker').datepicker({
							uiLibrary: 'bootstrap4',
							format: 'dd-mm-yyyy'
						});
					</script>
					<div class="col-xs-3" style="width: 275px;margin-top: 30px;">

						<input class="form-control" id="numberOfPatient" type="text" placeholder="Number of Patient ">
					</div>

					<div class="appointment">
						<div class="button appointment_btn">
							<a href="javascript: addAvailability();"> Patient Want to Visit</a>
						</div>
					</div>
					</form>
				</div>
			</div>

		</div>


	</div>

	</div>

	</div>

	<script>
		function addAvailability() {
			var today = new Date();
			var date = today.getDate() + '-' + (today.getMonth() + 1) + '-' + today.getFullYear();
			var currentdates = date.split('-')
			var currentdateval = Number(currentdates[0] + currentdates[1] + currentdates[2]);

			var data = JSON.parse(window.localStorage.getItem('user'));
			var apdate = document.getElementById('datepicker').value;
			var apdates = apdate.split('-');
			var apdateval = Number(apdates[0] + apdates[1] + apdates[2]);
			console.log(currentdateval + "   " + apdateval)
			if (currentdateval > apdateval) {
				Swal.fire({
					icon: 'error',
					title: 'Oops...',
					text: 'Please select a valid date',
					footer: '<a href = "home.html"><b>Go to home</b></a>'
				});
			}
			else {

				var url = backendurl + "api/addavailability/" + data.phonenumber + "/" + document.getElementById('datepicker').value + "/" + document.getElementById('numberOfPatient').value;
				// {doctorphonenumber}/{date}/{numberOfPatient}

				var xhr = new XMLHttpRequest();
				xhr.open("GET", url, true);
				var token = data.accessToken;
				console.log(data.accessToken)
				xhr.setRequestHeader("Authorization", "Bearer " + token);

				xhr.onload = function () {
					if (this.status == 200) {
						window.location.replace('doctordashboard.html');


					}
				};
				xhr.send();
			}
		}
	</script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="styles/bootstrap4/popper.js"></script>
	<script src="styles/bootstrap4/bootstrap.min.js"></script>
	<script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
	<script src="plugins/easing/easing.js"></script>
	<script src="plugins/parallax-js-master/parallax.min.js"></script>
	<script src="js/custom.js"></script>

</body>

</html>